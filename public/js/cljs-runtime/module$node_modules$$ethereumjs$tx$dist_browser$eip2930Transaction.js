shadow$provide.module$node_modules$$ethereumjs$tx$dist_browser$eip2930Transaction=function(global,require,module,exports){var Buffer=require("module$node_modules$buffer$index").Buffer;"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,
b$jscomp$0)};return function(d,b){function __(){this.constructor=d}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};return __assign.apply(this,
arguments)},__read=this&&this.__read||function(o,n){var m="function"===typeof Symbol&&o[Symbol.iterator];if(!m)return o;o=m.call(o);var r,ar=[];try{for(;(void 0===n||0<n--)&&!(r=o.next()).done;)ar.push(r.value)}catch(error){var e={error}}finally{try{r&&!r.done&&(m=o["return"])&&m.call(o)}finally{if(e)throw e.error;}}return ar};Object.defineProperty(exports,"__esModule",{value:!0});var ethereumjs_util_1=require("module$node_modules$ethereumjs_util$dist_browser$index");global=require("module$node_modules$$ethereumjs$tx$dist_browser$baseTransaction");
var types_1=require("module$node_modules$$ethereumjs$tx$dist_browser$types"),util_1=require("module$node_modules$$ethereumjs$tx$dist_browser$util"),TRANSACTION_TYPE_BUFFER=Buffer.from((1).toString(16).padStart(2,"0"),"hex");require=function(_super){function AccessListEIP2930Transaction(txData,opts){void 0===opts&&(opts={});var _a,_b,_this=_super.call(this,__assign(__assign({},txData),{type:1}))||this;_this.DEFAULT_HARDFORK="berlin";var accessList=txData.accessList,gasPrice=txData.gasPrice;_this.common=
_this._getCommon(opts.common,txData.chainId);_this.chainId=_this.common.chainIdBN();if(!_this.common.isActivatedEIP(2930))throw Error("EIP-2930 not enabled on Common");_this.activeCapabilities=_this.activeCapabilities.concat([2718,2930]);txData=util_1.AccessLists.getAccessListData(null!==accessList&&void 0!==accessList?accessList:[]);_this.accessList=txData.accessList;_this.AccessListJSON=txData.AccessListJSON;util_1.AccessLists.verifyAccessList(_this.accessList);_this.gasPrice=new ethereumjs_util_1.BN((0,ethereumjs_util_1.toBuffer)(""===
gasPrice?"0x":gasPrice));_this._validateCannotExceedMaxInteger({gasPrice:_this.gasPrice});if(_this.gasPrice.mul(_this.gasLimit).gt(ethereumjs_util_1.MAX_INTEGER))throw opts=_this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER"),Error(opts);if(_this.v&&!_this.v.eqn(0)&&!_this.v.eqn(1))throw opts=_this._errorMsg("The y-parity of the transaction should either be 0 or 1"),Error(opts);if(_this.common.gteHardfork("homestead")&&(null===(_a=_this.s)||void 0===_a?0:_a.gt(types_1.N_DIV_2)))throw opts=
_this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid"),Error(opts);(null!==(_b=null===opts||void 0===opts?void 0:opts.freeze)&&void 0!==_b?_b:1)&&Object.freeze(_this);return _this}__extends(AccessListEIP2930Transaction,_super);Object.defineProperty(AccessListEIP2930Transaction.prototype,"senderR",{get:function(){return this.r},enumerable:!1,configurable:!0});Object.defineProperty(AccessListEIP2930Transaction.prototype,"senderS",{get:function(){return this.s},
enumerable:!1,configurable:!0});Object.defineProperty(AccessListEIP2930Transaction.prototype,"yParity",{get:function(){return this.v},enumerable:!1,configurable:!0});AccessListEIP2930Transaction.fromTxData=function(txData,opts){void 0===opts&&(opts={});return new AccessListEIP2930Transaction(txData,opts)};AccessListEIP2930Transaction.fromSerializedTx=function(serialized,opts){void 0===opts&&(opts={});if(!serialized.slice(0,1).equals(TRANSACTION_TYPE_BUFFER))throw Error("Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: ".concat(1,
", received: ").concat(serialized.slice(0,1).toString("hex")));serialized=ethereumjs_util_1.rlp.decode(serialized.slice(1));if(!Array.isArray(serialized))throw Error("Invalid serialized tx input: must be array");return AccessListEIP2930Transaction.fromValuesArray(serialized,opts)};AccessListEIP2930Transaction.fromRlpSerializedTx=function(serialized,opts){void 0===opts&&(opts={});return AccessListEIP2930Transaction.fromSerializedTx(serialized,opts)};AccessListEIP2930Transaction.fromValuesArray=function(values,
opts){void 0===opts&&(opts={});if(8!==values.length&&11!==values.length)throw Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");var _a=__read(values,11);values=_a[0];var nonce=_a[1],gasPrice=_a[2],gasLimit=_a[3],to=_a[4],value=_a[5],data=_a[6],accessList=_a[7],v=_a[8],r=_a[9];_a=_a[10];(0,ethereumjs_util_1.validateNoLeadingZeroes)({nonce,gasPrice,gasLimit,value,v,r,s:_a});var emptyAccessList=[];return new AccessListEIP2930Transaction({chainId:new ethereumjs_util_1.BN(values),
nonce,gasPrice,gasLimit,to,value,data,accessList:null!==accessList&&void 0!==accessList?accessList:emptyAccessList,v:void 0!==v?new ethereumjs_util_1.BN(v):void 0,r,s:_a},opts)};AccessListEIP2930Transaction.prototype.getDataFee=function(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;var cost=_super.prototype.getDataFee.call(this);cost.iaddn(util_1.AccessLists.getDataFeeEIP2930(this.accessList,this.common));Object.isFrozen(this)&&(this.cache.dataFee=
{value:cost,hardfork:this.common.hardfork()});return cost};AccessListEIP2930Transaction.prototype.getUpfrontCost=function(){return this.gasLimit.mul(this.gasPrice).add(this.value)};AccessListEIP2930Transaction.prototype.raw=function(){return[(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.chainId),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.nonce),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasPrice),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasLimit),void 0!==this.to?this.to.buf:Buffer.from([]),
(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.value),this.data,this.accessList,void 0!==this.v?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.v):Buffer.from([]),void 0!==this.r?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.r):Buffer.from([]),void 0!==this.s?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.s):Buffer.from([])]};AccessListEIP2930Transaction.prototype.serialize=function(){var base=this.raw();return Buffer.concat([TRANSACTION_TYPE_BUFFER,ethereumjs_util_1.rlp.encode(base)])};AccessListEIP2930Transaction.prototype.getMessageToSign=
function(hashMessage){void 0===hashMessage&&(hashMessage=!0);var base=this.raw().slice(0,8);base=Buffer.concat([TRANSACTION_TYPE_BUFFER,ethereumjs_util_1.rlp.encode(base)]);return hashMessage?(0,ethereumjs_util_1.keccak256)(base):base};AccessListEIP2930Transaction.prototype.hash=function(){if(!this.isSigned()){var msg=this._errorMsg("Cannot call hash method if transaction is not signed");throw Error(msg);}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=(0,ethereumjs_util_1.keccak256)(this.serialize())),
this.cache.hash):(0,ethereumjs_util_1.keccak256)(this.serialize())};AccessListEIP2930Transaction.prototype.getMessageToVerifySignature=function(){return this.getMessageToSign()};AccessListEIP2930Transaction.prototype.getSenderPublicKey=function(){var _a;if(!this.isSigned()){var msg=this._errorMsg("Cannot call this method if transaction is not signed");throw Error(msg);}msg=this.getMessageToVerifySignature();if(this.common.gteHardfork("homestead")&&(null===(_a=this.s)||void 0===_a?0:_a.gt(types_1.N_DIV_2)))throw msg=
this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid"),Error(msg);_a=this.yParity;var r=this.r,s=this.s;try{return(0,ethereumjs_util_1.ecrecover)(msg,_a.addn(27),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(r),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(s))}catch(e){throw msg=this._errorMsg("Invalid Signature"),Error(msg);}};AccessListEIP2930Transaction.prototype._processSignature=function(v,r,s){var opts={common:this.common};return AccessListEIP2930Transaction.fromTxData({chainId:this.chainId,
nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:new ethereumjs_util_1.BN(v-27),r:new ethereumjs_util_1.BN(r),s:new ethereumjs_util_1.BN(s)},opts)};AccessListEIP2930Transaction.prototype.toJSON=function(){var accessListJSON=util_1.AccessLists.getAccessListJSON(this.accessList);return{chainId:(0,ethereumjs_util_1.bnToHex)(this.chainId),nonce:(0,ethereumjs_util_1.bnToHex)(this.nonce),gasPrice:(0,ethereumjs_util_1.bnToHex)(this.gasPrice),
gasLimit:(0,ethereumjs_util_1.bnToHex)(this.gasLimit),to:void 0!==this.to?this.to.toString():void 0,value:(0,ethereumjs_util_1.bnToHex)(this.value),data:"0x"+this.data.toString("hex"),accessList:accessListJSON,v:void 0!==this.v?(0,ethereumjs_util_1.bnToHex)(this.v):void 0,r:void 0!==this.r?(0,ethereumjs_util_1.bnToHex)(this.r):void 0,s:void 0!==this.s?(0,ethereumjs_util_1.bnToHex)(this.s):void 0}};AccessListEIP2930Transaction.prototype.errorStr=function(){var _a,_b,errorStr=this._getSharedErrorPostfix();
return errorStr+=" gasPrice\x3d".concat(this.gasPrice," accessListCount\x3d").concat(null!==(_b=null===(_a=this.accessList)||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0)};AccessListEIP2930Transaction.prototype._errorMsg=function(msg){return"".concat(msg," (").concat(this.errorStr(),")")};return AccessListEIP2930Transaction}(global.BaseTransaction);exports.default=require}
//# sourceMappingURL=module$node_modules$$ethereumjs$tx$dist_browser$eip2930Transaction.js.map
