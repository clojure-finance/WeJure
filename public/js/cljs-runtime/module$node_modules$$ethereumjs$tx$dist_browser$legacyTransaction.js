shadow$provide.module$node_modules$$ethereumjs$tx$dist_browser$legacyTransaction=function(global,require,module,exports){var Buffer=require("module$node_modules$buffer$index").Buffer;"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,
b$jscomp$0)};return function(d,b){function __(){this.constructor=d}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t};return __assign.apply(this,
arguments)},__read=this&&this.__read||function(o,n){var m="function"===typeof Symbol&&o[Symbol.iterator];if(!m)return o;o=m.call(o);var r,ar=[];try{for(;(void 0===n||0<n--)&&!(r=o.next()).done;)ar.push(r.value)}catch(error){var e={error}}finally{try{r&&!r.done&&(m=o["return"])&&m.call(o)}finally{if(e)throw e.error;}}return ar};Object.defineProperty(exports,"__esModule",{value:!0});var ethereumjs_util_1=require("module$node_modules$ethereumjs_util$dist_browser$index"),types_1=require("module$node_modules$$ethereumjs$tx$dist_browser$types");
global=function(_super){function Transaction(txData,opts){void 0===opts&&(opts={});var _a,_this=_super.call(this,__assign(__assign({},txData),{type:0}))||this;_this.common=_this._validateTxV(_this.v,opts.common);_this.gasPrice=new ethereumjs_util_1.BN((0,ethereumjs_util_1.toBuffer)(""===txData.gasPrice?"0x":txData.gasPrice));if(_this.gasPrice.mul(_this.gasLimit).gt(ethereumjs_util_1.MAX_INTEGER))throw opts=_this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)"),Error(opts);_this._validateCannotExceedMaxInteger({gasPrice:_this.gasPrice});
if(_this.common.gteHardfork("spuriousDragon"))if(_this.isSigned()){txData=_this.v;var chainIdDoubled=_this.common.chainIdBN().muln(2);(txData.eq(chainIdDoubled.addn(35))||txData.eq(chainIdDoubled.addn(36)))&&_this.activeCapabilities.push(types_1.Capability.EIP155ReplayProtection)}else _this.activeCapabilities.push(types_1.Capability.EIP155ReplayProtection);(null!==(_a=null===opts||void 0===opts?void 0:opts.freeze)&&void 0!==_a?_a:1)&&Object.freeze(_this);return _this}__extends(Transaction,_super);
Transaction.fromTxData=function(txData,opts){void 0===opts&&(opts={});return new Transaction(txData,opts)};Transaction.fromSerializedTx=function(serialized,opts){void 0===opts&&(opts={});serialized=ethereumjs_util_1.rlp.decode(serialized);if(!Array.isArray(serialized))throw Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(serialized,opts)};Transaction.fromRlpSerializedTx=function(serialized,opts){void 0===opts&&(opts={});return Transaction.fromSerializedTx(serialized,
opts)};Transaction.fromValuesArray=function(values,opts){void 0===opts&&(opts={});if(6!==values.length&&9!==values.length)throw Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");var _a=__read(values,9);values=_a[0];var gasPrice=_a[1],gasLimit=_a[2],to=_a[3],value=_a[4],data=_a[5],v=_a[6],r=_a[7];_a=_a[8];(0,ethereumjs_util_1.validateNoLeadingZeroes)({nonce:values,gasPrice,gasLimit,value,v,r,s:_a});return new Transaction({nonce:values,gasPrice,gasLimit,
to,value,data,v,r,s:_a},opts)};Transaction.prototype.raw=function(){return[(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.nonce),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasPrice),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasLimit),void 0!==this.to?this.to.buf:Buffer.from([]),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.value),this.data,void 0!==this.v?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.v):Buffer.from([]),void 0!==this.r?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.r):Buffer.from([]),
void 0!==this.s?(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.s):Buffer.from([])]};Transaction.prototype.serialize=function(){return ethereumjs_util_1.rlp.encode(this.raw())};Transaction.prototype._getMessageToSign=function(){var values=[(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.nonce),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasPrice),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.gasLimit),void 0!==this.to?this.to.buf:Buffer.from([]),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(this.value),
this.data];this.supports(types_1.Capability.EIP155ReplayProtection)&&(values.push((0,ethereumjs_util_1.toBuffer)(this.common.chainIdBN())),values.push((0,ethereumjs_util_1.unpadBuffer)((0,ethereumjs_util_1.toBuffer)(0))),values.push((0,ethereumjs_util_1.unpadBuffer)((0,ethereumjs_util_1.toBuffer)(0))));return values};Transaction.prototype.getMessageToSign=function(hashMessage){void 0===hashMessage&&(hashMessage=!0);var message=this._getMessageToSign();return hashMessage?(0,ethereumjs_util_1.rlphash)(message):
message};Transaction.prototype.getDataFee=function(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;Object.isFrozen(this)&&(this.cache.dataFee={value:_super.prototype.getDataFee.call(this),hardfork:this.common.hardfork()});return _super.prototype.getDataFee.call(this)};Transaction.prototype.getUpfrontCost=function(){return this.gasLimit.mul(this.gasPrice).add(this.value)};Transaction.prototype.hash=function(){return Object.isFrozen(this)?
(this.cache.hash||(this.cache.hash=(0,ethereumjs_util_1.rlphash)(this.raw())),this.cache.hash):(0,ethereumjs_util_1.rlphash)(this.raw())};Transaction.prototype.getMessageToVerifySignature=function(){if(!this.isSigned()){var msg=this._errorMsg("This transaction is not signed");throw Error(msg);}msg=this._getMessageToSign();return(0,ethereumjs_util_1.rlphash)(msg)};Transaction.prototype.getSenderPublicKey=function(){var _a,msgHash=this.getMessageToVerifySignature();if(this.common.gteHardfork("homestead")&&
(null===(_a=this.s)||void 0===_a?0:_a.gt(types_1.N_DIV_2)))throw msgHash=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid"),Error(msgHash);_a=this.v;var r=this.r,s=this.s;try{return(0,ethereumjs_util_1.ecrecover)(msgHash,_a,(0,ethereumjs_util_1.bnToUnpaddedBuffer)(r),(0,ethereumjs_util_1.bnToUnpaddedBuffer)(s),this.supports(types_1.Capability.EIP155ReplayProtection)?this.common.chainIdBN():void 0)}catch(e){throw msgHash=this._errorMsg("Invalid Signature"),
Error(msgHash);}};Transaction.prototype._processSignature=function(v,r,s){v=new ethereumjs_util_1.BN(v);this.supports(types_1.Capability.EIP155ReplayProtection)&&v.iadd(this.common.chainIdBN().muln(2).addn(8));var opts={common:this.common};return Transaction.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v,r:new ethereumjs_util_1.BN(r),s:new ethereumjs_util_1.BN(s)},opts)};Transaction.prototype.toJSON=function(){return{nonce:(0,ethereumjs_util_1.bnToHex)(this.nonce),
gasPrice:(0,ethereumjs_util_1.bnToHex)(this.gasPrice),gasLimit:(0,ethereumjs_util_1.bnToHex)(this.gasLimit),to:void 0!==this.to?this.to.toString():void 0,value:(0,ethereumjs_util_1.bnToHex)(this.value),data:"0x"+this.data.toString("hex"),v:void 0!==this.v?(0,ethereumjs_util_1.bnToHex)(this.v):void 0,r:void 0!==this.r?(0,ethereumjs_util_1.bnToHex)(this.r):void 0,s:void 0!==this.s?(0,ethereumjs_util_1.bnToHex)(this.s):void 0}};Transaction.prototype._validateTxV=function(v,common){if(!(void 0===v||v.eqn(0)||
common&&!common.gteHardfork("spuriousDragon")||v.eqn(27)||v.eqn(28)))if(common){var chainIdDoubled=common.chainIdBN().muln(2);if(!v.eq(chainIdDoubled.addn(35))&&!v.eq(chainIdDoubled.addn(36)))throw Error("Incompatible EIP155-based V ".concat(v," and chain id ").concat(common.chainIdBN(),". See the Common parameter of the Transaction constructor to set the chain id."));}else{var chainIdBN=v.subn(35).isEven()?35:36;chainIdBN=v.subn(chainIdBN).divn(2)}return this._getCommon(common,chainIdBN)};Transaction.prototype._unsignedTxImplementsEIP155=
function(){return this.common.gteHardfork("spuriousDragon")};Transaction.prototype._signedTxImplementsEIP155=function(){if(!this.isSigned()){var msg=this._errorMsg("This transaction is not signed");throw Error(msg);}msg=this.common.gteHardfork("spuriousDragon");var v=this.v,chainIdDoubled=this.common.chainIdBN().muln(2);return(v.eq(chainIdDoubled.addn(35))||v.eq(chainIdDoubled.addn(36)))&&msg};Transaction.prototype.errorStr=function(){var errorStr=this._getSharedErrorPostfix();return errorStr+=" gasPrice\x3d".concat(this.gasPrice)};
Transaction.prototype._errorMsg=function(msg){return"".concat(msg," (").concat(this.errorStr(),")")};return Transaction}(require("module$node_modules$$ethereumjs$tx$dist_browser$baseTransaction").BaseTransaction);exports.default=global}
//# sourceMappingURL=module$node_modules$$ethereumjs$tx$dist_browser$legacyTransaction.js.map
