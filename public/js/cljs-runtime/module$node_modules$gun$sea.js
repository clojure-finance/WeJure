shadow$provide.module$node_modules$gun$sea=function(global,require,module$jscomp$0,exports){var Buffer=require("module$node_modules$buffer$index").Buffer;(function(){function USE(arg,req){return req?require(arg):arg.slice?USE[arg.split("/").slice(-1).toString().replace(".js","")]:function(mod,path){arg(mod={exports:{}});USE[path.split("/").slice(-1).toString().replace(".js","")]=mod.exports}}if("undefined"!==typeof module$jscomp$0)var MODULE=module$jscomp$0;USE(function(module){"undefined"!==typeof self&&
(module.window=self);"undefined"!==typeof window&&(module.window=window);var SEA=(module.window||module).SEA||{};if(SEA.window=module.window)SEA.window.SEA=SEA;try{"undefined"!==typeof MODULE&&(MODULE.exports=SEA)}catch(e){}module.exports=SEA})(USE,"./root");USE(function(module){module=USE("./root");try{module.window&&0>location.protocol.indexOf("s")&&0>location.host.indexOf("localhost")&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&0>location.protocol.indexOf("file:")&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),
location.protocol="https:")}catch(e){}})(USE,"./https");USE(function(module){if("undefined"==typeof btoa){if("undefined"==typeof Buffer)try{global.Buffer=USE("buffer",1).Buffer}catch(e){console.log("Please `npm install buffer` or add it to your package.json !")}global.btoa=function(data){return Buffer.from(data,"binary").toString("base64")};global.atob=function(data){return Buffer.from(data,"base64").toString("binary")}}})(USE,"./base64");USE(function(module){function SeaArray(){}USE("./base64");
Object.assign(SeaArray,{from:Array.from});SeaArray.prototype=Object.create(Array.prototype);SeaArray.prototype.toString=function(enc,start,end){enc=enc||"utf8";start=start||0;const length=this.length;if("hex"===enc){const buf=new Uint8Array(this);return[...Array((end&&end+1||length)-start).keys()].map(i=>buf[i+start].toString(16).padStart(2,"0")).join("")}if("utf8"===enc)return Array.from({length:(end||length)-start},(_,i)=>String.fromCharCode(this[i+start])).join("");if("base64"===enc)return btoa(this)};
module.exports=SeaArray})(USE,"./array");USE(function(module){function SafeBuffer(...props){console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()");return SafeBuffer.from(...props)}USE("./base64");var SeaArray=USE("./array");SafeBuffer.prototype=Object.create(Array.prototype);Object.assign(SafeBuffer,{from(){if(!Object.keys(arguments).length||null==arguments[0])throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const input=
arguments[0];if("string"===typeof input){var enc=arguments[1]||"utf8";if("hex"===enc){var buf=input.match(/([\da-fA-F]{2})/g).map(byte=>parseInt(byte,16));if(!buf||!buf.length)throw new TypeError("Invalid first argument for type 'hex'.");buf=SeaArray.from(buf)}else if("utf8"===enc||"binary"===enc){buf=input.length;const words=new Uint16Array(buf);Array.from({length:buf},(_,i)=>words[i]=input.charCodeAt(i));buf=SeaArray.from(words)}else if("base64"===enc){const dec=atob(input);buf=dec.length;const bytes=
new Uint8Array(buf);Array.from({length:buf},(_,i)=>bytes[i]=dec.charCodeAt(i));buf=SeaArray.from(bytes)}else"binary"===enc?buf=SeaArray.from(input):console.info("SafeBuffer.from unknown encoding: "+enc);return buf}if(input.byteLength||input.length)return input instanceof ArrayBuffer&&(enc=new Uint8Array(input)),SeaArray.from(enc||input)},alloc(length,fill=0){return SeaArray.from(new Uint8Array(Array.from({length},()=>fill)))},allocUnsafe(length){return SeaArray.from(new Uint8Array(Array.from({length})))},
concat(arr){if(!Array.isArray(arr))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return SeaArray.from(arr.reduce((ret,item)=>ret.concat(Array.from(item)),[]))}});SafeBuffer.prototype.from=SafeBuffer.from;SafeBuffer.prototype.toString=SeaArray.prototype.toString;module.exports=SafeBuffer})(USE,"./buffer");USE(function(module){const SEA=USE("./root"),api={Buffer:USE("./buffer")};var o={};JSON.parseAsync=JSON.parseAsync||function(t,cb,r){try{cb(void 0,
JSON.parse(t,r))}catch(e){cb(e)}};JSON.stringifyAsync=JSON.stringifyAsync||function(v,cb,r,s){try{cb(void 0,JSON.stringify(v,r,s))}catch(e){cb(e)}};api.parse=function(t,r){return new Promise(function(res,rej){JSON.parseAsync(t,function(err,raw){err?rej(err):res(raw)},r)})};api.stringify=function(v,r,s){return new Promise(function(res,rej){JSON.stringifyAsync(v,function(err,raw){err?rej(err):res(raw)},r,s)})};SEA.window&&(api.crypto=SEA.window.crypto||SEA.window.msCrypto,api.subtle=(api.crypto||o).subtle||
(api.crypto||o).webkitSubtle,api.TextEncoder=SEA.window.TextEncoder,api.TextDecoder=SEA.window.TextDecoder,api.random=len=>api.Buffer.from(api.crypto.getRandomValues(new Uint8Array(api.Buffer.alloc(len)))));if(!api.TextDecoder){const {TextEncoder,TextDecoder}=USE(("undefined"==typeof MODULE?".":"")+"./lib/text-encoding",1);api.TextDecoder=TextDecoder;api.TextEncoder=TextEncoder}if(!api.crypto)try{var crypto=USE("crypto",1);Object.assign(api,{crypto,random:len=>api.Buffer.from(crypto.randomBytes(len))});
const {Crypto:WebCrypto}=USE("@peculiar/webcrypto",1);api.ossl=api.subtle=(new WebCrypto({directory:"ossl"})).subtle}catch(e){console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}module.exports=api})(USE,"./shim");USE(function(module){var SEA=USE("./root"),shim=USE("./shim"),s={pbkdf2:{hash:{name:"SHA-256"},iter:1E5,ks:64},ecdsa:{pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},ecdh:{name:"ECDH",namedCurve:"P-256"},jwk:function(pub,
d){pub=pub.split(".");pub={kty:"EC",crv:"P-256",x:pub[0],y:pub[1],ext:!0};pub.key_ops=d?["sign"]:["verify"];d&&(pub.d=d);return pub},keyToJwk:function(keyBytes){return{kty:"oct",k:keyBytes.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),ext:!1,alg:"A256GCM"}},recall:{validity:43200,hook:function(props){return props}},check:function(t){return"string"==typeof t&&"SEA{"===t.slice(0,4)},parse:async function(t){try{var yes="string"==typeof t;yes&&"SEA{"===t.slice(0,4)&&(t=t.slice(3));
return yes?await shim.parse(t):t}catch(e){}return t}};SEA.opt=s;module.exports=s})(USE,"./settings");USE(function(module){var shim=USE("./shim");module.exports=async function(d,o){d="string"==typeof d?d:await shim.stringify(d);o=await shim.subtle.digest({name:o||"SHA-256"},(new shim.TextEncoder).encode(d));return shim.Buffer.from(o)}})(USE,"./sha256");USE(function(module){const __shim=USE("./shim"),subtle=__shim.subtle,ossl=__shim.ossl?__shim.ossl:subtle;module.exports=b=>ossl.digest({name:"SHA-1"},
new ArrayBuffer(b))})(USE,"./sha1");USE(function(module){var SEA=USE("./root"),shim=USE("./shim"),S=USE("./settings"),sha=USE("./sha256");SEA.work=SEA.work||(async(data,pair,cb,opt)=>{try{var salt=(pair||{}).epub||pair;opt=opt||{};salt instanceof Function&&(cb=salt,salt=void 0);data="string"==typeof data?data:await shim.stringify(data);if("sha"===(opt.name||"").toLowerCase().slice(0,3)){var rsha=shim.Buffer.from(await sha(data,opt.name),"binary").toString(opt.encode||"base64");if(cb)try{cb(rsha)}catch(e){console.log(e)}return rsha}salt=
salt||shim.random(9);var key=await (shim.ossl||shim.subtle).importKey("raw",(new shim.TextEncoder).encode(data),{name:opt.name||"PBKDF2"},!1,["deriveBits"]),work=await (shim.ossl||shim.subtle).deriveBits({name:opt.name||"PBKDF2",iterations:opt.iterations||S.pbkdf2.iter,salt:(new shim.TextEncoder).encode(opt.salt||salt),hash:opt.hash||S.pbkdf2.hash},key,opt.length||8*S.pbkdf2.ks);shim.random(data.length);var r=shim.Buffer.from(work,"binary").toString(opt.encode||"base64");if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);
SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.work})(USE,"./work");USE(function(module){var SEA=USE("./root"),shim=USE("./shim");USE("./settings");SEA.name=SEA.name||(async(cb,opt)=>{try{if(cb)try{cb()}catch(e){console.log(e)}}catch(e){console.log(e);SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});SEA.pair=SEA.pair||(async(cb,opt)=>{try{var ecdhSubtle=shim.ossl||shim.subtle,sa=await shim.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async keys=>{var key=
{};key.priv=(await shim.subtle.exportKey("jwk",keys.privateKey)).d;keys=await shim.subtle.exportKey("jwk",keys.publicKey);key.pub=keys.x+"."+keys.y;return key});try{var dh=await ecdhSubtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async keys=>{var key={};key.epriv=(await ecdhSubtle.exportKey("jwk",keys.privateKey)).d;keys=await ecdhSubtle.exportKey("jwk",keys.publicKey);key.epub=keys.x+"."+keys.y;return key})}catch(e){if(SEA.window)throw e;if("Error: ECDH is not a supported algorithm"==
e)console.log("Ignoring ECDH...");else throw e;}dh=dh||{};var r={pub:sa.pub,priv:sa.priv,epub:dh.epub,epriv:dh.epriv};if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.pair})(USE,"./pair");USE(function(module){var SEA=USE("./root"),shim=USE("./shim"),S=USE("./settings"),sha=USE("./sha256");SEA.sign=SEA.sign||(async(data,pair,cb,opt)=>{try{opt=opt||{};if(!(pair||opt).priv){if(!SEA.I)throw"No signing key.";pair=await SEA.I(null,
{what:data,how:"sign",why:opt.why})}if(void 0===data)throw"`undefined` not allowed.";var json=await S.parse(data),check=opt.check=opt.check||json;if(SEA.verify&&(SEA.opt.check(check)||check&&check.s&&check.m)&&void 0!==await SEA.verify(check,pair)){var r=await S.parse(check);opt.raw||(r="SEA"+await shim.stringify(r));if(cb)try{cb(r)}catch(e){console.log(e)}return r}var jwk=S.jwk(pair.pub,pair.priv),hash=await sha(json),sig=await (shim.ossl||shim.subtle).importKey("jwk",jwk,{name:"ECDSA",namedCurve:"P-256"},
!1,["sign"]).then(key=>(shim.ossl||shim.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},key,new Uint8Array(hash)));r={m:json,s:shim.Buffer.from(sig,"binary").toString(opt.encode||"base64")};opt.raw||(r="SEA"+await shim.stringify(r));if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.sign})(USE,"./sign");USE(function(module){var SEA=USE("./root"),shim=USE("./shim"),S=USE("./settings"),sha=USE("./sha256");SEA.verify=
SEA.verify||(async(data,pair,cb,opt)=>{try{var json=await S.parse(data);if(!1===pair){var raw=await S.parse(json.m);if(cb)try{cb(raw)}catch(e){console.log(e)}return raw}opt=opt||{};var pub=pair.pub||pair,key=SEA.opt.slow_leak?await SEA.opt.slow_leak(pub):await (shim.ossl||shim.subtle).importKey("jwk",S.jwk(pub),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),hash=await sha(json.m);try{var buf=shim.Buffer.from(json.s,opt.encode||"base64");var sig=new Uint8Array(buf);var check=await (shim.ossl||shim.subtle).verify({name:"ECDSA",
hash:{name:"SHA-256"}},key,sig,new Uint8Array(hash));if(!check)throw"Signature did not match.";}catch(e){if(SEA.opt.fallback)return await SEA.opt.fall_verify(data,pair,cb,opt)}var r=check?await S.parse(json.m):void 0;if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.verify;var knownKeys={};SEA.opt.slow_leak=pair=>{if(knownKeys[pair])return knownKeys[pair];var jwk=S.jwk(pair);knownKeys[pair]=(shim.ossl||shim.subtle).importKey("jwk",
jwk,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]);return knownKeys[pair]};var O=SEA.opt;SEA.opt.fall_verify=async function(data,pair,cb,opt,f){if(f===SEA.opt.fallback)throw"Signature did not match";f=f||1;var tmp=data||"";data=SEA.opt.unpack(data)||data;var json=await S.parse(data);pair=await SEA.opt.slow_leak(pair.pub||pair);f=f<=SEA.opt.fallback?shim.Buffer.from(await shim.subtle.digest({name:"SHA-256"},(new shim.TextEncoder).encode(await S.parse(json.m)))):await sha(json.m);try{var buf=shim.Buffer.from(json.s,
opt.encode||"base64");var sig=new Uint8Array(buf);var check=await (shim.ossl||shim.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},pair,sig,new Uint8Array(f));if(!check)throw"Signature did not match.";}catch(e$jscomp$0){try{buf=shim.Buffer.from(json.s,"utf8"),sig=new Uint8Array(buf),check=await (shim.ossl||shim.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},pair,sig,new Uint8Array(f))}catch(e){if(!check)throw"Signature did not match.";}}opt=check?await S.parse(json.m):void 0;O.fall_soul=
tmp["#"];O.fall_key=tmp["."];O.fall_val=data;O.fall_state=tmp["\x3e"];if(cb)try{cb(opt)}catch(e){console.log(e)}return opt};SEA.opt.fallback=2})(USE,"./verify");USE(function(module){var shim=USE("./shim"),S=USE("./settings"),sha256hash=USE("./sha256");module.exports=async(key,salt,opt)=>{key+=(salt||shim.random(8)).toString("utf8");key=shim.Buffer.from(await sha256hash(key),"binary");key=S.keyToJwk(key);return await shim.subtle.importKey("jwk",key,{name:"AES-GCM"},!1,["encrypt","decrypt"])}})(USE,
"./aeskey");USE(function(module){var SEA=USE("./root"),shim=USE("./shim");USE("./settings");var aeskey=USE("./aeskey");SEA.encrypt=SEA.encrypt||(async(data,pair,cb,opt)=>{try{opt=opt||{};var key=(pair||opt).epriv||pair;if(void 0===data)throw"`undefined` not allowed.";if(!key){if(!SEA.I)throw"No encryption key.";pair=await SEA.I(null,{what:data,how:"encrypt",why:opt.why});key=pair.epriv||pair}var msg="string"==typeof data?data:await shim.stringify(data),JSCompiler_object_inline_s_112=shim.random(9),
JSCompiler_object_inline_iv_113=shim.random(15),ct=await aeskey(key,JSCompiler_object_inline_s_112,opt).then(aes=>shim.subtle.encrypt({name:opt.name||"AES-GCM",iv:new Uint8Array(JSCompiler_object_inline_iv_113)},aes,(new shim.TextEncoder).encode(msg))),r={ct:shim.Buffer.from(ct,"binary").toString(opt.encode||"base64"),iv:JSCompiler_object_inline_iv_113.toString(opt.encode||"base64"),s:JSCompiler_object_inline_s_112.toString(opt.encode||"base64")};opt.raw||(r="SEA"+await shim.stringify(r));if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);
SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.encrypt})(USE,"./encrypt");USE(function(module){var SEA=USE("./root"),shim=USE("./shim"),S=USE("./settings"),aeskey=USE("./aeskey");SEA.decrypt=SEA.decrypt||(async(data,pair,cb,opt)=>{try{opt=opt||{};var key=(pair||opt).epriv||pair;if(!key){if(!SEA.I)throw"No decryption key.";pair=await SEA.I(null,{what:data,how:"decrypt",why:opt.why});key=pair.epriv||pair}var json=await S.parse(data);try{var buf=shim.Buffer.from(json.s,opt.encode||"base64");
var bufiv=shim.Buffer.from(json.iv,opt.encode||"base64");var bufct=shim.Buffer.from(json.ct,opt.encode||"base64");var ct=await aeskey(key,buf,opt).then(aes=>shim.subtle.decrypt({name:opt.name||"AES-GCM",iv:new Uint8Array(bufiv),tagLength:128},aes,new Uint8Array(bufct)))}catch(e){if("utf8"===opt.encode)throw"Could not decrypt";if(SEA.opt.fallback)return opt.encode="utf8",await SEA.decrypt(data,pair,cb,opt)}var r=await S.parse((new shim.TextDecoder("utf8")).decode(ct));if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);
SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.decrypt})(USE,"./decrypt");USE(function(module){var SEA=USE("./root"),shim=USE("./shim");USE("./settings");SEA.secret=SEA.secret||(async(key,pair,cb,opt)=>{try{opt=opt||{};if(!pair||!pair.epriv||!pair.epub){if(!SEA.I)throw"No secret mix.";pair=await SEA.I(null,{what:key,how:"secret",why:opt.why})}var epub=pair.epub,epriv=pair.epriv,ecdhSubtle=shim.ossl||shim.subtle,pubKeyData=keysToEcdhJwk(key.epub||key),props=Object.assign({public:await ecdhSubtle.importKey(...pubKeyData,
!0,[])},{name:"ECDH",namedCurve:"P-256"}),privKeyData=keysToEcdhJwk(epub,epriv),r=await ecdhSubtle.importKey(...privKeyData,!1,["deriveBits"]).then(async privKey=>{privKey=await ecdhSubtle.deriveBits(props,privKey,256);privKey=new Uint8Array(privKey);privKey=await ecdhSubtle.importKey("raw",privKey,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return ecdhSubtle.exportKey("jwk",privKey).then(({k})=>k)});if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){console.log(e);SEA.err=e;if(SEA.throw)throw e;
cb&&cb()}});var keysToEcdhJwk=(pub,d)=>{var [x,y]=pub.split(".");return["jwk",Object.assign(d?{d}:{},{x,y,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};module.exports=SEA.secret})(USE,"./secret");USE(function(module){var SEA=USE("./root");SEA.certify=SEA.certify||(async(certificants,policy={},authority,cb,opt={})=>{try{console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version.");certificants=
(()=>{var data=[];if(certificants){if(("string"===typeof certificants||Array.isArray(certificants))&&-1<certificants.indexOf("*"))return"*";if("string"===typeof certificants)return certificants;if(Array.isArray(certificants)){if(1===certificants.length&&certificants[0])return"object"===typeof certificants[0]&&certificants[0].pub?certificants[0].pub:"string"===typeof certificants[0]?certificants[0]:null;certificants.map(certificant=>{"string"===typeof certificant?data.push(certificant):"object"===
typeof certificant&&certificant.pub&&data.push(certificant.pub)})}return"object"===typeof certificants&&certificants.pub?certificants.pub:0<data.length?data:null}})();if(!certificants)return console.log("No certificant found.");const expiry=!opt.expiry||"number"!==typeof opt.expiry&&"string"!==typeof opt.expiry?null:parseFloat(opt.expiry),readPolicy=(policy||{}).read?policy.read:null,writePolicy=(policy||{}).write?policy.write:"string"===typeof policy||Array.isArray(policy)||policy["+"]||policy["#"]||
policy["."]||policy["\x3d"]||policy["*"]||policy["\x3e"]||policy["\x3c"]?policy:null,block=(opt||{}).block||(opt||{}).blacklist||(opt||{}).ban||{},readBlock=block.read&&("string"===typeof block.read||(block.read||{})["#"])?block.read:null,writeBlock="string"===typeof block?block:block.write&&("string"===typeof block.write||block.write["#"])?block.write:null;if(!readPolicy&&!writePolicy)return console.log("No policy found.");const data$jscomp$0=JSON.stringify({c:certificants,...(expiry?{e:expiry}:
{}),...(readPolicy?{r:readPolicy}:{}),...(writePolicy?{w:writePolicy}:{}),...(readBlock?{rb:readBlock}:{}),...(writeBlock?{wb:writeBlock}:{})});var r=await SEA.sign(data$jscomp$0,authority,null,{raw:1});opt.raw||(r="SEA"+JSON.stringify(r));if(cb)try{cb(r)}catch(e){console.log(e)}return r}catch(e){SEA.err=e;if(SEA.throw)throw e;cb&&cb()}});module.exports=SEA.certify})(USE,"./certify");USE(function(module){var shim=USE("./shim"),SEA=USE("./root");SEA.work=USE("./work");SEA.sign=USE("./sign");SEA.verify=
USE("./verify");SEA.encrypt=USE("./encrypt");SEA.decrypt=USE("./decrypt");SEA.certify=USE("./certify");SEA.random=SEA.random||shim.random;SEA.Buffer=SEA.Buffer||USE("./buffer");SEA.keyid=SEA.keyid||(async pub=>{try{const pb=shim.Buffer.concat(pub.replace(/-/g,"+").replace(/_/g,"/").split(".").map(t=>shim.Buffer.from(t,"base64"))),id=shim.Buffer.concat([shim.Buffer.from([153,pb.length/256,pb.length%256]),pb]),sha1=await sha1hash(id),hash=shim.Buffer.from(sha1,"binary");return hash.toString("hex",hash.length-
8)}catch(e){throw console.log(e),e;}});((SEA.window||{}).GUN||{}).SEA=SEA;module.exports=SEA})(USE,"./sea");USE(function(module){function User(root){this._={$:this}}function lex(){return Gun.state().toString(36).replace(".","")}var SEA=USE("./sea");var Gun=SEA.window?SEA.window.GUN||{chain:{}}:USE(("undefined"==typeof MODULE?".":"")+"./gun",1);SEA.GUN=Gun;User.prototype=function(){function F(){}F.prototype=Gun.chain;return new F}();User.prototype.constructor=User;Gun.chain.user=function(pub$jscomp$0){var root=
this.back(-1);if(pub$jscomp$0)return pub$jscomp$0=SEA.opt.pub((pub$jscomp$0._||"")["#"])||pub$jscomp$0,root.get("~"+pub$jscomp$0);if(pub$jscomp$0=root.back("user"))return pub$jscomp$0;var at=root=root._,uuid=at.opt.uuid||lex;(at=(pub$jscomp$0=at.user=this.chain(new User))._).opt={};at.opt.uuid=function(cb){var id=uuid(),pub=root.user;if(!pub||!(pub=pub.is)||!(pub=pub.pub))return id;id="~"+pub+"/"+id;cb&&cb.call&&cb(null,id);return id};return pub$jscomp$0};Gun.User=User;User.GUN=Gun;User.SEA=Gun.SEA=
SEA;module.exports=User})(USE,"./user");USE(function(module){("undefined"!=typeof GUN?GUN||{chain:{}}:USE(("undefined"===typeof MODULE?".":"")+"./gun",1)).chain.then=function(cb,opt){var gun=this,p=new Promise(function(res,rej){gun.once(res,opt)});return cb?p.then(cb):p}})(USE,"./then");USE(function(module){module=USE("./user");var SEA=module.SEA,Gun=module.GUN,noop=function(){};module.prototype.create=function(...args){var pair$jscomp$0="object"===typeof args[0]&&(args[0].pub||args[0].epub)?args[0]:
"object"===typeof args[1]&&(args[1].pub||args[1].epub)?args[1]:null,alias=pair$jscomp$0&&(pair$jscomp$0.pub||pair$jscomp$0.epub)?pair$jscomp$0.pub:"string"===typeof args[0]?args[0]:null,pass=pair$jscomp$0&&(pair$jscomp$0.pub||pair$jscomp$0.epub)?pair$jscomp$0:alias&&"string"===typeof args[1]?args[1]:null,cb=args.filter(arg=>"function"===typeof arg)[0]||null,opt=args&&1<args.length&&"object"===typeof args[args.length-1]?args[args.length-1]:{},gun=this,cat=gun._,root=gun.back(-1);cb=cb||noop;opt=opt||
{};if(!1!==opt.check){var err;alias||(err="No user.");8>(pass||"").length&&(err="Password too short!");if(err)return cb({err:Gun.log(err)}),gun}if(cat.ing)return(cb||noop)({err:Gun.log("User is already being created or authenticated!"),wait:!0}),gun;cat.ing=!0;var act={a:function(pubs){(act.pubs=pubs)&&!opt.already?(pubs={err:Gun.log("User already created!")},cat.ing=!1,(cb||noop)(pubs),gun.leave()):(act.salt=String.random(64),SEA.work(pass,act.salt,act.b))},b:function(proof){act.proof=proof;pair$jscomp$0?
act.c(pair$jscomp$0):SEA.pair(act.c)},c:function(pair){var tmp;act.pair=pair||{};if(tmp=cat.root.user)tmp._.sea=pair,tmp.is={pub:pair.pub,epub:pair.epub,alias};act.data={pub:pair.pub};act.d()},d:function(){act.data.alias=alias;act.e()},e:function(){act.data.epub=act.pair.epub;SEA.encrypt({priv:act.pair.priv,epriv:act.pair.epriv},act.proof,act.f,{raw:1})},f:function(auth){act.data.auth=JSON.stringify({ek:auth,s:act.salt});act.g(act.data.auth)},g:function(auth){act.data.auth=act.data.auth||auth;root.get(auth=
"~"+act.pair.pub).put(act.data).on(act.h);var link={};link[auth]={"#":auth};root.get("~@"+alias).put(link).get(auth).on(act.i)},h:function(data,key,msg,eve){eve.off();act.h.ok=1;act.i()},i:function(data,key,msg,eve){eve&&(act.i.ok=1,eve.off());act.h.ok&&act.i.ok&&(cat.ing=!1,cb({ok:0,pub:act.pair.pub}),noop===cb&&(pair$jscomp$0?gun.auth(pair$jscomp$0):gun.auth(alias,pass)))}};root.get("~@"+alias).once(act.a);return gun};module.prototype.leave=function(opt,cb){if(opt=this.back(-1)._.user)delete opt.is,
delete opt._.is,delete opt._.sea;if(SEA.window)try{opt={},opt=SEA.window.sessionStorage,delete opt.recall,delete opt.pair}catch(e){}return this}})(USE,"./create");USE(function(module){function obj_ify(o){if("string"!=typeof o)return o;try{o=JSON.parse(o)}catch(e){o={}}return o}module=USE("./user");var SEA=module.SEA,Gun=module.GUN,noop=function(){};module.prototype.auth=function(...args){var pair$jscomp$0="object"===typeof args[0]&&(args[0].pub||args[0].epub)?args[0]:"object"===typeof args[1]&&(args[1].pub||
args[1].epub)?args[1]:null,alias=pair$jscomp$0||"string"!==typeof args[0]?null:args[0],pass=!alias&&(!pair$jscomp$0||pair$jscomp$0.priv&&pair$jscomp$0.epriv)||"string"!==typeof args[1]?null:args[1],cb=args.filter(arg=>"function"===typeof arg)[0]||null,opt=args&&1<args.length&&"object"===typeof args[args.length-1]?args[args.length-1]:{},gun=this,cat=gun._,root=gun.back(-1);if(cat.ing)return(cb||noop)({err:Gun.log("User is already being created or authenticated!"),wait:!0}),gun;cat.ing=!0;var act={},
tries=9;act.a=function(data){if(!data)return act.b();if(!data.pub){var tmp=[];Object.keys(data).forEach(function(k){"_"!=k&&tmp.push(data[k])});return act.b(tmp)}if(act.name)return act.f(data);act.c((act.data=data).auth)};act.b=function(list){list=(act.list=(act.list||[]).concat(list||[])).shift();if(void 0===list){if(act.name)return act.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(alias&&
tries--){root.get("~@"+alias).once(act.a);return}return act.err("Wrong user or password.")}root.get(list).once(act.a)};act.c=function(auth){if(void 0===auth)return act.b();if("string"==typeof auth)return act.c(obj_ify(auth));SEA.work(pass,(act.auth=auth).s,act.d,act.enc)};act.d=function(proof){SEA.decrypt(act.auth.ek,proof,act.e,act.enc)};act.e=function(half){if(void 0===half){if(!act.enc)return act.enc={encode:"utf8"},act.c(act.auth);act.enc=null;return act.b()}act.half=half;act.f(act.data)};act.f=
function(pair){var half=act.half||{},data=act.data||{};act.g(act.lol={pub:pair.pub||data.pub,epub:pair.epub||data.epub,priv:pair.priv||half.priv,epriv:pair.epriv||half.epriv})};act.g=function(pair){if(!pair||!pair.pub||!pair.epub)return act.b();act.pair=pair;var user=root._.user,at=user._,upt=at.opt;at=user._=root.get("~"+pair.pub)._;at.opt=upt;user.is={pub:pair.pub,epub:pair.epub,alias:alias||pair.pub};at.sea=act.pair;cat.ing=!1;try{pass&&void 0==(obj_ify(cat.root.graph["~"+pair.pub].auth)||"")[":"]&&
(opt.shuffle=opt.change=pass)}catch(e){}opt.change?act.z():(cb||noop)(at);if(SEA.window&&(gun.back("user")._.opt||opt).remember)try{user={},user=SEA.window.sessionStorage,user.recall=!0,user.pair=JSON.stringify(pair)}catch(e){}try{if(root._.tag.auth)root._.on("auth",at);else setTimeout(function(){root._.on("auth",at)},1)}catch(e){Gun.log("Your 'auth' callback crashed with:",e)}};act.h=function(data){if(!data)return act.b();alias=data.alias;alias||(alias=data.alias="~"+pair$jscomp$0.pub);if(!data.auth)return act.g(pair$jscomp$0);
pair$jscomp$0=null;act.c((act.data=data).auth)};act.z=function(){act.salt=String.random(64);SEA.work(opt.change,act.salt,act.y)};act.y=function(proof){SEA.encrypt({priv:act.pair.priv,epriv:act.pair.epriv},proof,act.x,{raw:1})};act.x=function(auth){act.w(JSON.stringify({ek:auth,s:act.salt}))};act.w=function(auth){if(opt.shuffle){console.log("migrate core account from UTF8 \x26 shuffle");var tmp={};Object.keys(act.data).forEach(function(k){tmp[k]=act.data[k]});delete tmp._;tmp.auth=auth;root.get("~"+
act.pair.pub).put(tmp)}root.get("~"+act.pair.pub).get("auth").put(auth,cb||noop)};act.err=function(e){e={err:Gun.log(e||"User cannot be found!")};cat.ing=!1;(cb||noop)(e)};act.plugin=function(name){if(!(act.name=name))return act.err();var tmp=[name];"~"!==name[0]&&(tmp[1]="~"+name,tmp[2]="~@"+name);act.b(tmp)};if(pair$jscomp$0)if(pair$jscomp$0.priv&&pair$jscomp$0.epriv)act.g(pair$jscomp$0);else root.get("~"+pair$jscomp$0.pub).once(act.h);else if(alias)root.get("~@"+alias).once(act.a);else alias||
pass||SEA.name(act.plugin);return gun}})(USE,"./auth");USE(function(module){module=USE("./user");var SEA=module.SEA;module.prototype.recall=function(opt,cb){var root=this.back(-1);if((opt=opt||{},opt.sessionStorage)&&SEA.window)try{var sS={};if(sS=SEA.window.sessionStorage)root._.opt.remember=!0,(this.back("user")._.opt||opt).remember=!0,(sS.recall||sS.pair)&&root.user().auth(JSON.parse(sS.pair),cb)}catch(e){}return this}})(USE,"./recall");USE(function(module){var User=USE("./user"),SEA=User.SEA,
Gun=User.GUN,noop=function(){};User.prototype.pair=function(){var user=this;try{var proxy=new Proxy({DANGER:"☠"},{get:function(t,p,r){if(user.is&&(user._||"").sea)return user._.sea[p]}})}catch(e){}return proxy};User.prototype.delete=async function(alias,pass,cb){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");this.back(-1);var user=this.back("user");try{user.auth(alias,pass,function(ack){user.map().once(function(){this.put(null)});user.leave();(cb||noop)({ok:0})})}catch(e){Gun.log("User.delete failed! Error:",
e)}return this};User.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const gunRoot=this.back(-1);try{return await authRecall(gunRoot),gunRoot._.user._}catch(e){throw Gun.log("No session!"),{err:"No session!"};}};User.prototype.trust=async function(user){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");Gun.is(user)&&user.get("pub").get((ctx,ev)=>{console.log(ctx,ev)});user.get("trust").get(path).put(theirPubkey)};User.prototype.grant=function(to,
cb){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var user=this.back(-1).user(),pair=user._.sea,path="";this.back(function(at){at.is||(path+=at.get||"")});(async function(){var sec=await user.get("grant").get(pair.pub).get(path).then();sec=await SEA.decrypt(sec,pair);if(!sec){sec=SEA.random(16).toString();var enc=await SEA.encrypt(sec,pair);user.get("grant").get(pair.pub).get(path).put(enc)}var pub=to.get("pub").then();enc=to.get("epub").then();pub=await pub;enc=await enc;
enc=await SEA.secret(enc,pair);enc=await SEA.encrypt(sec,enc);user.get("grant").get(pub).get(path).put(enc,cb)})();return this};User.prototype.secret=function(data,cb){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var gun=this,user=gun.back(-1).user(),pair=user.pair(),path="";gun.back(function(at){at.is||(path+=at.get||"")});(async function(){var sec=await user.get("trust").get(pair.pub).get(path).then();sec=await SEA.decrypt(sec,pair);if(!sec){sec=SEA.random(16).toString();
var enc=await SEA.encrypt(sec,pair);user.get("trust").get(pair.pub).get(path).put(enc)}enc=await SEA.encrypt(data,sec);gun.put(enc,cb)})();return gun};module.exports=User})(USE,"./share");USE(function(module){function check(msg){var eve=this,at=eve.as,put=msg.put,soul=put["#"],key=put["."],val=put[":"],state=put["\x3e"],id=msg["#"],tmp;if(soul&&key)if((msg._||"").faith&&(at.opt||"").faith&&"function"==typeof msg._)SEA.opt.pack(put,function(raw){SEA.verify(raw,!1,function(data){put["\x3d"]=SEA.opt.unpack(data);
eve.to.next(msg)})});else{var no=function(why){at.on("in",{"@":id,err:msg.err=why})};(msg._||"").DBG&&((msg._||"").DBG.c=+new Date);if(0<=soul.indexOf("\x3c?")&&(tmp=parseFloat(soul.split("\x3c?")[1]||""))&&state<Gun.state()-1E3*tmp){(tmp=msg._)&&tmp.stun&&tmp.stun--;return}"~@"===soul?check.alias(eve,msg,val,key,soul,at,no):"~@"===soul.slice(0,2)?check.pubs(eve,msg,val,key,soul,at,no):(tmp=SEA.opt.pub(soul))?check.pub(eve,msg,val,key,soul,at,no,at.user||"",tmp):0<=soul.indexOf("#")?check.hash(eve,
msg,val,key,soul,at,no):check.any(eve,msg,val,key,soul,at,no,at.user||"")}}var SEA=USE("./sea"),S=USE("./settings"),Gun=(SEA.window||"").GUN||USE(("undefined"===typeof MODULE?".":"")+"./gun",1);Gun.on("opt",function(at){at.sea||(at.sea={own:{}},at.on("put",check,at));this.to.next(at)});check.hash=function(eve,msg,val,key,soul,at,no){SEA.work(val,null,function(data){if(data&&data===key.split("#").slice(-1)[0])return eve.to.next(msg);var JSCompiler_temp;if(JSCompiler_temp=data){JSCompiler_temp=key.split("#").slice(-1)[0];
let base64="";for(let i=0;i<JSCompiler_temp.length;i++)base64+=i-1&1?"":String.fromCharCode(parseInt(JSCompiler_temp.substring(i-1,i+1),16));JSCompiler_temp=btoa(base64);JSCompiler_temp=data===JSCompiler_temp}if(JSCompiler_temp)return eve.to.next(msg);no("Data hash not same as hash!")},{name:"SHA-256"})};check.alias=function(eve,msg,val,key,soul,at,no){if(!val)return no("Data must exist!");if("~@"+key===link_is(val))return eve.to.next(msg);no("Alias not same!")};check.pubs=function(eve,msg,val,key,
soul,at,no){if(!val)return no("Alias must exist!");if(key===link_is(val))return eve.to.next(msg);no("Alias not same!")};check.pub=async function(eve,msg,val,key,soul,at,no,user,pub){var tmp$jscomp$0;const raw=await S.parse(val)||{},verify=(certificate,certificant,cb)=>{if(certificate.m&&certificate.s&&certificant&&pub)return SEA.verify(certificate,pub,data=>{if(void 0!==data&&void 0!==data.e&&msg.put["\x3e"]&&msg.put["\x3e"]>parseFloat(data.e))return no("Certificate expired.");if(void 0!==data&&data.c&&
data.w&&(data.c===certificant||-1<data.c.indexOf("*"))){var path=-1<soul.indexOf("/")?soul.replace(soul.substring(0,soul.indexOf("/")+1),""):"";String.match=String.match||Gun.text.match;const w=Array.isArray(data.w)?data.w:"object"===typeof data.w||"string"===typeof data.w?[data.w]:[];for(const lex of w)if(String.match(path,lex["#"])&&String.match(key,lex["."])||!lex["."]&&String.match(path,lex["#"])||!lex["#"]&&String.match(key,lex["."])||String.match(path?path+"/"+key:key,lex["#"]||lex))return lex["+"]&&
-1<lex["+"].indexOf("*")&&path&&-1==path.indexOf(certificant)&&-1==key.indexOf(certificant)?no(`Path "${path}" or key "${key}" must contain string "${certificant}".`):data.wb&&("string"===typeof data.wb||(data.wb||{})["#"])?(path=eve.as.root.$.back(-1),"string"===typeof data.wb&&"~"!==data.wb.slice(0,1)&&(path=path.get("~"+pub)),path.get(data.wb).get(certificant).once(value=>!value||1!==value&&!0!==value?cb(data):no(`Certificant ${certificant} blocked.`))):cb(data);return no("Certificate verification fail.")}})};
if("pub"===key&&"~"+pub===soul)return val===pub?eve.to.next(msg):no("Account not same!");(tmp$jscomp$0=user.is)&&tmp$jscomp$0.pub&&!raw["*"]&&!raw["+"]&&(pub===tmp$jscomp$0.pub||pub!==tmp$jscomp$0.pub&&((msg._.msg||{}).opt||{}).cert)?SEA.opt.pack(msg.put,packed=>{SEA.sign(packed,user._.sea,async function(data){if(void 0===data)return no(SEA.err||"Signature fail.");msg.put[":"]={":":tmp$jscomp$0=SEA.opt.unpack(data.m),"~":data.s};msg.put["\x3d"]=tmp$jscomp$0;if(pub===user.is.pub){if(tmp$jscomp$0=link_is(val))(at.sea.own[tmp$jscomp$0]=
at.sea.own[tmp$jscomp$0]||{})[pub]=1;JSON.stringifyAsync(msg.put[":"],function(err,s){if(err)return no(err||"Stringify error.");msg.put[":"]=s;return eve.to.next(msg)})}else if(pub!==user.is.pub&&((msg._.msg||{}).opt||{}).cert){const cert=await S.parse(msg._.msg.opt.cert);cert&&cert.m&&cert.s&&verify(cert,user.is.pub,_=>{msg.put[":"]["+"]=cert;msg.put[":"]["*"]=user.is.pub;JSON.stringifyAsync(msg.put[":"],function(err,s){if(err)return no(err||"Stringify error.");msg.put[":"]=s;return eve.to.next(msg)})})}},
{raw:1})}):SEA.opt.pack(msg.put,packed=>{SEA.verify(packed,raw["*"]||pub,function(data){var tmp;data=SEA.opt.unpack(data);if(void 0===data)return no("Unverified data.");(tmp=link_is(data))&&pub===SEA.opt.pub(tmp)&&((at.sea.own[tmp]=at.sea.own[tmp]||{})[pub]=1);if(raw["+"]&&raw["+"].m&&raw["+"].s&&raw["*"])verify(raw["+"],raw["*"],_=>{msg.put["\x3d"]=data;return eve.to.next(msg)});else return msg.put["\x3d"]=data,eve.to.next(msg)})})};check.any=function(eve,msg$jscomp$0,val,key,soul,at,no,user){if(at.opt.secure)return no("Soul missing public key at '"+
key+"'.");at.on("secure",function(msg){this.off();if(!at.opt.secure)return eve.to.next(msg);no("Data cannot be changed.")}).on.on("secure",msg$jscomp$0)};var valid=Gun.valid,link_is=function(d,l){return"string"==typeof(l=valid(d))&&l},pubcut=/[^\w_-]/;SEA.opt.pub=function(s){if(s&&(s=s.split("~"))&&(s=s[1])&&(s=s.split(pubcut).slice(0,2))&&2==s.length&&"@"!==(s[0]||"")[0])return s=s.slice(0,2).join(".")};SEA.opt.stringy=function(t){};SEA.opt.pack=function(d,cb,k,n,s){if(SEA.opt.check(d))return cb(d);
if(d&&d["#"]&&d["."]&&d["\x3e"]){var tmp=d[":"];var f=1}JSON.parseAsync(f?tmp:d,function(err,meta){(err=void 0!==(meta||"")[":"]&&(meta||"")["~"])?cb({m:{"#":s||d["#"],".":k||d["."],":":(meta||"")[":"],"\x3e":d["\x3e"]||Gun.state.is(n,k)},s:err}):cb(d)})};var O=SEA.opt;SEA.opt.unpack=function(d,k,n){var tmp;if(void 0!==d){if(d&&void 0!==(tmp=d[":"]))return tmp;k=k||O.fall_key;!n&&O.fall_val&&(n={},n[k]=O.fall_val);if(k&&n){if(d===n[k]||!SEA.opt.check(n[k]))return d;tmp=n&&n._&&n._["#"]||O.fall_soul;
n=Gun.state.is(n,k)||O.fall_state;if(d&&4===d.length&&tmp===d[0]&&k===d[1]&&fl(n)===fl(d[3]))return d[2];if(n<SEA.opt.shuffle_attack)return d}}};SEA.opt.shuffle_attack=15463296E5;var fl=Math.floor})(USE,"./index")})()}
//# sourceMappingURL=module$node_modules$gun$sea.js.map
