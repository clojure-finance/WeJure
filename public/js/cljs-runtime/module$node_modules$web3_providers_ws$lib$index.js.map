{
"version":3,
"file":"module$node_modules$web3_providers_ws$lib$index.js",
"lineCount":12,
"mappings":"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",
"sources":["node_modules/web3-providers-ws/lib/index.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$web3_providers_ws$lib$index\"] = function(global,require,module,exports) {\n/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @file WebsocketProvider.js\n * @authors: Samuel Furter <samuel@ethereum.org>, Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2019\n */\n'use strict';\nvar EventEmitter = require('eventemitter3');\nvar helpers = require('./helpers.js');\nvar errors = require('web3-core-helpers').errors;\nvar Ws = require('websocket').w3cwebsocket;\n/**\n * @param {string} url\n * @param {Object} options\n *\n * @constructor\n */\nvar WebsocketProvider = function WebsocketProvider(url, options) {\n    EventEmitter.call(this);\n    options = options || {};\n    this.url = url;\n    this._customTimeout = options.timeout || 1000 * 15;\n    this.headers = options.headers || {};\n    this.protocol = options.protocol || undefined;\n    this.reconnectOptions = Object.assign({\n        auto: false,\n        delay: 5000,\n        maxAttempts: false,\n        onTimeout: false\n    }, options.reconnect);\n    this.clientConfig = options.clientConfig || undefined; // Allow a custom client configuration\n    this.requestOptions = options.requestOptions || undefined; // Allow a custom request options (https://github.com/theturtle32/WebSocket-Node/blob/master/docs/WebSocketClient.md#connectrequesturl-requestedprotocols-origin-headers-requestoptions)\n    this.DATA = 'data';\n    this.CLOSE = 'close';\n    this.ERROR = 'error';\n    this.CONNECT = 'connect';\n    this.RECONNECT = 'reconnect';\n    this.connection = null;\n    this.requestQueue = new Map();\n    this.responseQueue = new Map();\n    this.reconnectAttempts = 0;\n    this.reconnecting = false;\n    // The w3cwebsocket implementation does not support Basic Auth\n    // username/password in the URL. So generate the basic auth header, and\n    // pass through with any additional headers supplied in constructor\n    var parsedURL = helpers.parseURL(url);\n    if (parsedURL.username && parsedURL.password) {\n        this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.username + ':' + parsedURL.password);\n    }\n    // When all node core implementations that do not have the\n    // WHATWG compatible URL parser go out of service this line can be removed.\n    if (parsedURL.auth) {\n        this.headers.authorization = 'Basic ' + helpers.btoa(parsedURL.auth);\n    }\n    // make property `connected` which will return the current connection status\n    Object.defineProperty(this, 'connected', {\n        get: function () {\n            return this.connection && this.connection.readyState === this.connection.OPEN;\n        },\n        enumerable: true\n    });\n    this.connect();\n};\n// Inherit from EventEmitter\nWebsocketProvider.prototype = Object.create(EventEmitter.prototype);\nWebsocketProvider.prototype.constructor = WebsocketProvider;\n/**\n * Connects to the configured node\n *\n * @method connect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.connect = function () {\n    this.connection = new Ws(this.url, this.protocol, undefined, this.headers, this.requestOptions, this.clientConfig);\n    this._addSocketListeners();\n};\n/**\n * Listener for the `data` event of the underlying WebSocket object\n *\n * @method _onMessage\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onMessage = function (e) {\n    var _this = this;\n    this._parseResponse((typeof e.data === 'string') ? e.data : '').forEach(function (result) {\n        if (result.method && result.method.indexOf('_subscription') !== -1) {\n            _this.emit(_this.DATA, result);\n            return;\n        }\n        var id = result.id;\n        // get the id which matches the returned id\n        if (Array.isArray(result)) {\n            id = result[0].id;\n        }\n        if (_this.responseQueue.has(id)) {\n            if (_this.responseQueue.get(id).callback !== undefined) {\n                _this.responseQueue.get(id).callback(false, result);\n            }\n            _this.responseQueue.delete(id);\n        }\n    });\n};\n/**\n * Listener for the `open` event of the underlying WebSocket object\n *\n * @method _onConnect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onConnect = function () {\n    this.emit(this.CONNECT);\n    this.reconnectAttempts = 0;\n    this.reconnecting = false;\n    if (this.requestQueue.size > 0) {\n        var _this = this;\n        this.requestQueue.forEach(function (request, key) {\n            _this.send(request.payload, request.callback);\n            _this.requestQueue.delete(key);\n        });\n    }\n};\n/**\n * Listener for the `close` event of the underlying WebSocket object\n *\n * @method _onClose\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._onClose = function (event) {\n    var _this = this;\n    if (this.reconnectOptions.auto && (![1000, 1001].includes(event.code) || event.wasClean === false)) {\n        this.reconnect();\n        return;\n    }\n    this.emit(this.CLOSE, event);\n    if (this.requestQueue.size > 0) {\n        this.requestQueue.forEach(function (request, key) {\n            request.callback(errors.ConnectionNotOpenError(event));\n            _this.requestQueue.delete(key);\n        });\n    }\n    if (this.responseQueue.size > 0) {\n        this.responseQueue.forEach(function (request, key) {\n            request.callback(errors.InvalidConnection('on WS', event));\n            _this.responseQueue.delete(key);\n        });\n    }\n    this._removeSocketListeners();\n    this.removeAllListeners();\n};\n/**\n * Will add the required socket listeners\n *\n * @method _addSocketListeners\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._addSocketListeners = function () {\n    this.connection.addEventListener('message', this._onMessage.bind(this));\n    this.connection.addEventListener('open', this._onConnect.bind(this));\n    this.connection.addEventListener('close', this._onClose.bind(this));\n};\n/**\n * Will remove all socket listeners\n *\n * @method _removeSocketListeners\n *\n * @returns {void}\n */\nWebsocketProvider.prototype._removeSocketListeners = function () {\n    this.connection.removeEventListener('message', this._onMessage);\n    this.connection.removeEventListener('open', this._onConnect);\n    this.connection.removeEventListener('close', this._onClose);\n};\n/**\n * Will parse the response and make an array out of it.\n *\n * @method _parseResponse\n *\n * @param {String} data\n *\n * @returns {Array}\n */\nWebsocketProvider.prototype._parseResponse = function (data) {\n    var _this = this, returnValues = [];\n    // DE-CHUNKER\n    var dechunkedData = data\n        .replace(/\\}[\\n\\r]?\\{/g, '}|--|{') // }{\n        .replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{') // }][{\n        .replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{') // }[{\n        .replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{') // }]{\n        .split('|--|');\n    dechunkedData.forEach(function (data) {\n        // prepend the last chunk\n        if (_this.lastChunk)\n            data = _this.lastChunk + data;\n        var result = null;\n        try {\n            result = JSON.parse(data);\n        }\n        catch (e) {\n            _this.lastChunk = data;\n            // start timeout to cancel all requests\n            clearTimeout(_this.lastChunkTimeout);\n            _this.lastChunkTimeout = setTimeout(function () {\n                if (_this.reconnectOptions.auto && _this.reconnectOptions.onTimeout) {\n                    _this.reconnect();\n                    return;\n                }\n                _this.emit(_this.ERROR, errors.ConnectionTimeout(_this._customTimeout));\n                if (_this.requestQueue.size > 0) {\n                    _this.requestQueue.forEach(function (request, key) {\n                        request.callback(errors.ConnectionTimeout(_this._customTimeout));\n                        _this.requestQueue.delete(key);\n                    });\n                }\n            }, _this._customTimeout);\n            return;\n        }\n        // cancel timeout and set chunk to null\n        clearTimeout(_this.lastChunkTimeout);\n        _this.lastChunk = null;\n        if (result)\n            returnValues.push(result);\n    });\n    return returnValues;\n};\n/**\n * Does check if the provider is connecting and will add it to the queue or will send it directly\n *\n * @method send\n *\n * @param {Object} payload\n * @param {Function} callback\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.send = function (payload, callback) {\n    var _this = this;\n    var id = payload.id;\n    var request = { payload: payload, callback: callback };\n    if (Array.isArray(payload)) {\n        id = payload[0].id;\n    }\n    if (this.connection.readyState === this.connection.CONNECTING || this.reconnecting) {\n        this.requestQueue.set(id, request);\n        return;\n    }\n    if (this.connection.readyState !== this.connection.OPEN) {\n        this.requestQueue.delete(id);\n        this.emit(this.ERROR, errors.ConnectionNotOpenError());\n        request.callback(errors.ConnectionNotOpenError());\n        return;\n    }\n    this.responseQueue.set(id, request);\n    this.requestQueue.delete(id);\n    try {\n        this.connection.send(JSON.stringify(request.payload));\n    }\n    catch (error) {\n        request.callback(error);\n        _this.responseQueue.delete(id);\n    }\n};\n/**\n * Resets the providers, clears all callbacks\n *\n * @method reset\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.reset = function () {\n    this.responseQueue.clear();\n    this.requestQueue.clear();\n    this.removeAllListeners();\n    this._removeSocketListeners();\n    this._addSocketListeners();\n};\n/**\n * Closes the current connection with the given code and reason arguments\n *\n * @method disconnect\n *\n * @param {number} code\n * @param {string} reason\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.disconnect = function (code, reason) {\n    this._removeSocketListeners();\n    this.connection.close(code || 1000, reason);\n};\n/**\n * Returns the desired boolean.\n *\n * @method supportsSubscriptions\n *\n * @returns {boolean}\n */\nWebsocketProvider.prototype.supportsSubscriptions = function () {\n    return true;\n};\n/**\n * Removes the listeners and reconnects to the socket.\n *\n * @method reconnect\n *\n * @returns {void}\n */\nWebsocketProvider.prototype.reconnect = function () {\n    var _this = this;\n    this.reconnecting = true;\n    if (this.responseQueue.size > 0) {\n        this.responseQueue.forEach(function (request, key) {\n            request.callback(errors.PendingRequestsOnReconnectingError());\n            _this.responseQueue.delete(key);\n        });\n    }\n    if (!this.reconnectOptions.maxAttempts ||\n        this.reconnectAttempts < this.reconnectOptions.maxAttempts) {\n        setTimeout(function () {\n            _this.reconnectAttempts++;\n            _this._removeSocketListeners();\n            _this.emit(_this.RECONNECT, _this.reconnectAttempts);\n            _this.connect();\n        }, this.reconnectOptions.delay);\n        return;\n    }\n    this.emit(this.ERROR, errors.MaxAttemptsReachedOnReconnectingError());\n    this.reconnecting = false;\n    if (this.requestQueue.size > 0) {\n        this.requestQueue.forEach(function (request, key) {\n            request.callback(errors.MaxAttemptsReachedOnReconnectingError());\n            _this.requestQueue.delete(key);\n        });\n    }\n};\nmodule.exports = WebsocketProvider;\n\n};"],
"names":["shadow$provide","global","require","module","exports","EventEmitter","helpers","errors","Ws","w3cwebsocket","WebsocketProvider","url","options","call","_customTimeout","timeout","headers","protocol","undefined","reconnectOptions","Object","assign","auto","delay","maxAttempts","onTimeout","reconnect","clientConfig","requestOptions","DATA","CLOSE","ERROR","CONNECT","RECONNECT","connection","requestQueue","Map","responseQueue","reconnectAttempts","reconnecting","parsedURL","parseURL","username","password","authorization","btoa","auth","defineProperty","get","readyState","OPEN","enumerable","connect","prototype","create","constructor","WebsocketProvider.prototype.connect","_addSocketListeners","_onMessage","WebsocketProvider.prototype._onMessage","e","_this","_parseResponse","data","forEach","result","method","indexOf","emit","id","Array","isArray","has","callback","delete","_onConnect","WebsocketProvider.prototype._onConnect","size","request","key","send","payload","_onClose","WebsocketProvider.prototype._onClose","event","includes","code","wasClean","ConnectionNotOpenError","InvalidConnection","_removeSocketListeners","removeAllListeners","WebsocketProvider.prototype._addSocketListeners","addEventListener","bind","WebsocketProvider.prototype._removeSocketListeners","removeEventListener","WebsocketProvider.prototype._parseResponse","returnValues","replace","split","dechunkedData","lastChunk","JSON","parse","clearTimeout","lastChunkTimeout","setTimeout","ConnectionTimeout","push","WebsocketProvider.prototype.send","CONNECTING","set","stringify","error","reset","WebsocketProvider.prototype.reset","clear","disconnect","WebsocketProvider.prototype.disconnect","reason","close","supportsSubscriptions","WebsocketProvider.prototype.supportsSubscriptions","WebsocketProvider.prototype.reconnect","PendingRequestsOnReconnectingError","MaxAttemptsReachedOnReconnectingError"]
}
